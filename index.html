<!DOCTYPE html>
<html lang="ar" dir="rtl" id="htmlTag" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>شهريتي | إدارة الميزانية الشخصية</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* الأساسيات */
        :root {
            --primary-color: #3498db;
            --secondary-color: #2c3e50;
            --success-color: #2ecc71;
            --warning-color: #f1c40f;
            --danger-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --text-color: #333;
            --bg-color: #f5f7fa;
            --card-bg: white;
            --border-color: #ddd;
            --shadow-color: rgba(0, 0, 0, 0.1);
            --border-radius: 8px;
        }

        [data-theme="dark"] {
            --bg-color: #1a1a2e;
            --text-color: #f1f1f1;
            --card-bg: #16213e;
            --border-color: #2d4059;
            --shadow-color: rgba(0, 0, 0, 0.3);
            --primary-color: #4a89dc;
            --secondary-color: #e6e6e6;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Tajawal', Arial, sans-serif;
        }

        body {
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--bg-color);
            transition: all 0.3s ease;
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* الشريط العلوي */
        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo svg {
            height: 40px;
            width: auto;
        }

        .logo-text {
            font-weight: 700;
            font-size: 1.5rem;
            color: var(--secondary-color);
        }

        .auth-buttons {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 8px 16px;
            border-radius: var(--border-radius);
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
        }

        /* الصفحة الرئيسية */
        .hero {
            text-align: center;
            padding: 60px 0;
        }

        .hero h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            color: var(--secondary-color);
        }

        .hero h1 span {
            color: var(--primary-color);
        }

        .hero p {
            font-size: 1.2rem;
            color: var(--text-color);
            opacity: 0.8;
            max-width: 700px;
            margin: 0 auto 30px;
        }

        /* خيارات الصفحة الرئيسية */
        .home-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }

        .option-card {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            border: 1px solid var(--border-color);
        }

        .option-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px var(--shadow-color);
        }

        .option-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .option-card h3 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        /* روابط التواصل الاجتماعي */
        .social-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 40px;
        }

        .social-link {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .social-link:hover {
            transform: scale(1.2);
        }

        .facebook {
            color: #1877F2;
            background-color: rgba(24, 119, 242, 0.1);
        }

        .twitter {
            color: #1DA1F2;
            background-color: rgba(29, 161, 242, 0.1);
        }

        .telegram {
            color: #0088CC;
            background-color: rgba(0, 136, 204, 0.1);
        }

        .social-link svg {
            width: 20px;
            height: 20px;
        }

        /* حاسبة الميزانية */
        .calculator {
            background-color: var(--card-bg);
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: 0 5px 15px var(--shadow-color);
            margin: 30px auto;
            border: 1px solid var(--border-color);
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--secondary-color);
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: border-color 0.3s;
            background-color: var(--card-bg);
            color: var(--text-color);
        }

        select.form-control {
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 15px;
        }

        .calculate-btn {
            background: linear-gradient(135deg, var(--primary-color), #2980b9);
            color: white;
            padding: 15px 30px;
            font-size: 1.1rem;
            width: 100%;
            max-width: 300px;
            margin: 20px auto;
            display: block;
        }

        /* النتائج */
        .result {
            margin-top: 30px;
            padding: 25px;
            background-color: var(--light-color);
            border-radius: var(--border-radius);
            display: none;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .highlight {
            font-weight: 700;
            font-size: 1.1rem;
        }

        .advice-box {
            margin-top: 15px;
            padding: 15px;
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--primary-color);
        }

        /* أزرار التحكم */
        .control-buttons {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 100;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .control-btn {
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 5px var(--shadow-color);
            transition: all 0.3s;
        }

        .control-btn:hover {
            transform: scale(1.1);
        }

        /* تجاوب */
        @media (max-width: 768px) {
            .top-bar {
                flex-direction: column;
                gap: 15px;
            }
            
            .auth-buttons {
                width: 100%;
                justify-content: center;
            }
            
            .hero h1 {
                font-size: 2rem;
            }
            
            .home-options {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- شريط التنقل العلوي -->
    <div class="container top-bar">
        <div class="logo">
            <svg viewBox="0 0 300 100" xmlns="http://www.w3.org/2000/svg">
                <path fill="#3498db" d="M150,20 Q180,40 150,60 Q120,40 150,20 Z"/>
                <text x="150" y="40" font-size="28" text-anchor="middle" fill="#2c3e50" font-family="Tajawal">شهريتي</text>
                <text x="150" y="80" font-size="20" text-anchor="middle" fill="#f1c40f" font-family="Montserrat">Shahryati</text>
            </svg>
            <span class="logo-text">شهريتي</span>
        </div>
        <div class="auth-buttons" id="authButtons">
            <button class="btn btn-outline" onclick="showAuthForm('login')" data-translate="loginBtn">تسجيل الدخول</button>
            <button class="btn btn-primary" onclick="showAuthForm('register')" data-translate="registerBtn">إنشاء حساب</button>
        </div>
        <div class="user-menu" id="userMenu" style="display: none;">
            <span id="usernameDisplay"></span>
            <button class="btn btn-outline" onclick="logout()" data-translate="logoutBtn">تسجيل الخروج</button>
        </div>
    </div>

    <!-- المحتوى الرئيسي -->
    <div class="container">
        <!-- الصفحة الرئيسية -->
        <div id="homePage">
            <div class="hero">
                <h1 data-translate="welcomeTitle">مرحباً بك في <span>شهريتي</span></h1>
                <p data-translate="welcomeSubtitle">أداة متكاملة لإدارة ميزانيتك الشخصية وتتبع نفقاتك الشهرية بكل سهولة</p>
                
                <!-- خيارات الصفحة الرئيسية -->
                <div class="home-options">
                    <div class="option-card" onclick="startCalculator()">
                        <div class="option-icon">🧮</div>
                        <h3 data-translate="calculatorOption">حاسبة الميزانية</h3>
                        <p data-translate="calculatorDesc">احسب دخلك ونفقاتك الشهرية</p>
                    </div>
                    
                    <div class="option-card" onclick="showAuthForm('register')">
                        <div class="option-icon">👤</div>
                        <h3 data-translate="registerOption">إنشاء حساب</h3>
                        <p data-translate="registerDesc">احفظ بياناتك وعدّل ميزانيتك لاحقاً</p>
                    </div>
                    
                    <div class="option-card" onclick="showComingSoon()">
                        <div class="option-icon">📊</div>
                        <h3 data-translate="reportsOption">التقارير</h3>
                        <p data-translate="reportsDesc">تحليل إنفاقك الشهري</p>
                    </div>
                </div>
                
                <!-- روابط التواصل الاجتماعي -->
                <div class="social-links">
                    <a href="#" class="social-link facebook" title="Facebook">
                        <svg width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M12 2.04C6.5 2.04 2 6.53 2 12.06C2 17.06 5.66 21.21 10.44 21.96V14.96H7.9V12.06H10.44V9.85C10.44 7.34 11.93 5.96 14.22 5.96C15.31 5.96 16.45 6.15 16.45 6.15V8.62H15.19C13.95 8.62 13.56 9.39 13.56 10.18V12.06H16.34L15.89 14.96H13.56V21.96A10 10 0 0 0 22 12.06C22 6.53 17.5 2.04 12 2.04Z"/></svg>
                    </a>
                    <a href="#" class="social-link twitter" title="Twitter">
                        <svg width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M22.46 6c-.77.35-1.6.58-2.46.69c.88-.53 1.56-1.37 1.88-2.38c-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29c0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15c0 1.49.75 2.81 1.91 3.56c-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07a4.28 4.28 0 0 0 4 2.98a8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21C16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56c.84-.6 1.56-1.36 2.14-2.23Z"/></svg>
                    </a>
                    <a href="#" class="social-link telegram" title="Telegram">
                        <svg width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10s10-4.48 10-10S17.52 2 12 2zm4.64 6.8c-.15 1.58-.8 5.42-1.13 7.19c-.14.75-.42 1-.68 1.03c-.58.05-1.02-.38-1.58-.75c-.88-.58-1.38-.94-2.23-1.5c-.99-.65-.35-1.01.22-1.59c.15-.15 2.71-2.48 2.76-2.69c.03-.1.06-.22-.1-.22-.1-.02-.21-.03-.3.1-.2.25-.76.81-1.51 1.47c-.54.48-.94.72-1.27.9c-.47.25-1.02.38-.98.8c.03.35.52.5 1.42.69c1.07.22 2.04.34 2.55.43c.83.14 1.93.17 2.57.07c.78-.13 1.82-.66 2.07-1.23c.26-.58.26-1.07.18-1.23c-.07-.16-.26-.25-.57-.43c-.25-.14-1.47-.74-1.69-.82c-.28-.11-.5-.17-.71.17c-.2.33-.77 1.13-.94 1.36c-.16.23-.33.26-.61.16c-.37-.13-1.12-.42-2.13-1.35c-.79-.72-1.33-1.6-1.48-1.87c-.15-.28-.02-.43.11-.57c.11-.11.25-.29.37-.43c.13-.14.17-.24.26-.4c.08-.17.04-.31-.02-.43c-.06-.11-.56-1.35-.77-1.84c-.2-.48-.4-.42-.56-.43c-.14 0-.3-.01-.47-.01c-.17 0-.45.06-.68.28c-.24.23-.92.9-.92 2.19c0 1.3.95 2.54 1.08 2.71c.12.17 1.88 2.86 4.56 4.08c.63.29 1.12.46 1.51.59c.63.21 1.2.19 1.65.11c.51-.08 1.57-.64 1.79-1.26c.22-.62.22-1.15.15-1.26c-.07-.1-.23-.16-.48-.27z"/></svg>
                    </a>
                </div>
            </div>
        </div>

        <!-- حاسبة الميزانية -->
        <div id="calculatorPage" style="display: none;">
            <div class="calculator">
                <h2 data-translate="calculatorTitle">حاسبة الميزانية الشهرية</h2>
                
                <div class="form-group">
                    <label for="currency" data-translate="currencyLabel">العملة:</label>
                    <select id="currency" class="form-control" onchange="updateCurrencySymbol()">
                        <option value="SAR">ريال سعودي (SAR)</option>
                        <option value="USD">دولار أمريكي (USD)</option>
                        <option value="EUR">يورو (EUR)</option>
                        <option value="AED">درهم إماراتي (AED)</option>
                        <option value="EGP">جنيه مصري (EGP)</option>
                        <option value="QAR">ريال قطري (QAR)</option>
                        <option value="DZD">دينار جزائري (DZD)</option>
                        <option value="TND">دينار تونسي (TND)</option>
                        <option value="MAD">درهم مغربي (MAD)</option>
                        <option value="LYD">دينار ليبي (LYD)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="income" data-translate="incomeLabel">الدخل الشهري (<span class="currency-symbol">ريال</span>):</label>
                    <input type="number" id="income" class="form-control" placeholder="أدخل إجمالي دخلك الشهري">
                </div>
                
                <h3 data-translate="expensesLabel">النفقات الثابتة:</h3>
                <div class="form-group">
                    <label for="rent" data-translate="rentLabel">الإيجار/الرهن العقاري:</label>
                    <input type="number" id="rent" class="form-control" placeholder="المبلغ الشهري">
                </div>
                
                <div class="form-group">
                    <label for="utilities" data-translate="utilitiesLabel">المرافق (كهرباء، ماء، إلخ):</label>
                    <input type="number" id="utilities" class="form-control" placeholder="المبلغ الشهري">
                </div>
                
                <div class="form-group">
                    <label for="transportation" data-translate="transportationLabel">المواصلات:</label>
                    <input type="number" id="transportation" class="form-control" placeholder="المبلغ الشهري">
                </div>
                
                <div class="form-group">
                    <label for="food" data-translate="foodLabel">الطعام والمشروبات:</label>
                    <input type="number" id="food" class="form-control" placeholder="المبلغ الشهري">
                </div>
                
                <div class="form-group">
                    <label for="other" data-translate="otherLabel">نفقات أخرى:</label>
                    <input type="number" id="other" class="form-control" placeholder="المبلغ الشهري">
                </div>
                
                <button class="btn btn-primary calculate-btn" onclick="calculateBudget()" data-translate="calculateBtn">حساب الميزانية</button>
                
                <div id="result" class="result">
                    <h3 data-translate="summaryTitle">ملخص الميزانية</h3>
                    <div class="summary-item">
                        <span data-translate="totalIncome">إجمالي الدخل:</span>
                        <span id="total-income">0 <span class="currency-symbol">ريال</span></span>
                    </div>
                    <div class="summary-item">
                        <span data-translate="totalExpenses">إجمالي النفقات:</span>
                        <span id="total-expenses">0 <span class="currency-symbol">ريال</span></span>
                    </div>
                    <div class="summary-item highlight">
                        <span data-translate="savingsLabel">المدخرات/العجز:</span>
                        <span id="savings">0 <span class="currency-symbol">ريال</span></span>
                    </div>
                    <div id="advice" class="advice-box">
                        <h4 data-translate="adviceTitle">نصائح مالية</h4>
                        <p id="adviceText">أدخل بياناتك للحصول على نصائح مخصصة</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- أزرار التحكم -->
    <div class="control-buttons">
        <button class="control-btn" onclick="toggleTheme()" id="themeBtn" title="وضع الليل">
            <span id="themeIcon">🌙</span>
        </button>
        <button class="control-btn" onclick="toggleLanguage()" id="languageBtn" title="تغيير اللغة">
            <span id="languageIcon">EN</span>
        </button>
    </div>

    <!-- نماذج المصادقة -->
    <div id="authModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center;">
        <div class="auth-form" id="loginForm">
            <h2 data-translate="loginTitle">تسجيل الدخول</h2>
            <div class="form-group">
                <label for="loginEmail" data-translate="emailLabel">البريد الإلكتروني:</label>
                <input type="email" id="loginEmail" class="form-control" placeholder="أدخل بريدك الإلكتروني">
            </div>
            <div class="form-group">
                <label for="loginPassword" data-translate="passwordLabel">كلمة المرور:</label>
                <input type="password" id="loginPassword" class="form-control" placeholder="أدخل كلمة المرور">
            </div>
            <button class="btn btn-primary" onclick="login()" data-translate="loginBtn">تسجيل الدخول</button>
            <p style="text-align: center; margin-top: 15px;">
                <span data-translate="noAccount">ليس لديك حساب؟</span> 
                <a href="#" onclick="showAuthForm('register')" data-translate="createAccount">أنشئ حساباً</a>
            </p>
        </div>

        <div class="auth-form" id="registerForm" style="display: none;">
            <h2 data-translate="registerTitle">إنشاء حساب جديد</h2>
            <div class="form-group">
                <label for="regName" data-translate="nameLabel">الاسم الكامل:</label>
                <input type="text" id="regName" class="form-control" placeholder="أدخل اسمك الكامل">
            </div>
            <div class="form-group">
                <label for="regEmail" data-translate="emailLabel">البريد الإلكتروني:</label>
                <input type="email" id="regEmail" class="form-control" placeholder="أدخل بريدك الإلكتروني">
            </div>
            <div class="form-group">
                <label for="regPassword" data-translate="passwordLabel">كلمة المرور:</label>
                <input type="password" id="regPassword" class="form-control" placeholder="أنشئ كلمة مرور قوية">
            </div>
            <button class="btn btn-primary" onclick="register()" data-translate="registerBtn">إنشاء حساب</button>
            <p style="text-align: center; margin-top: 15px;">
                <span data-translate="haveAccount">لديك حساب بالفعل؟</span> 
                <a href="#" onclick="showAuthForm('login')" data-translate="loginLink">سجل دخول</a>
            </p>
        </div>
    </div>

    <script>
        // حالة التطبيق
        const appState = {
            currentLanguage: 'ar',
            currentUser: null,
            users: JSON.parse(localStorage.getItem('users')) || [],
            darkMode: localStorage.getItem('theme') === 'dark',
            currentPage: 'home'
        };

        // أسعار الصرف (افتراضية)
        const exchangeRates = {
            SAR: 1,
            USD: 3.75,
            EUR: 4.45,
            AED: 1.02,
            EGP: 0.20,
            QAR: 1.03,
            DZD: 0.025,
            TND: 1.25,
            MAD: 0.35,
            LYD: 0.80
        };

        // رموز العملات
        const currencySymbols = {
            SAR: "ريال",
            USD: "$",
            EUR: "€",
            AED: "درهم",
            EGP: "جنيه",
            QAR: "ريال",
            DZD: "دينار",
            TND: "دينار",
            MAD: "درهم",
            LYD: "دينار"
        };

        // نظام الترجمة
        const translations = {
            ar: {
                'appTitle': 'شهريتي | إدارة الميزانية الشخصية',
                'welcomeTitle': 'مرحباً بك في شهريتي',
                'welcomeSubtitle': 'أداة متكاملة لإدارة ميزانيتك الشخصية',
                'loginBtn': 'تسجيل الدخول',
                'registerBtn': 'إنشاء حساب',
                'logoutBtn': 'تسجيل الخروج',
                'calculatorTitle': 'حاسبة الميزانية الشهرية',
                'currencyLabel': 'العملة:',
                'incomeLabel': 'الدخل الشهري:',
                'expensesLabel': 'النفقات الثابتة:',
                'rentLabel': 'الإيجار/الرهن العقاري:',
                'utilitiesLabel': 'المرافق (كهرباء، ماء، إلخ):',
                'transportationLabel': 'المواصلات:',
                'foodLabel': 'الطعام والمشروبات:',
                'otherLabel': 'نفقات أخرى:',
                'calculateBtn': 'حساب الميزانية',
                'summaryTitle': 'ملخص الميزانية',
                'totalIncome': 'إجمالي الدخل:',
                'totalExpenses': 'إجمالي النفقات:',
                'savingsLabel': 'المدخرات/العجز:',
                'adviceTitle': 'نصائح مالية',
                'calculatorOption': 'حاسبة الميزانية',
                'calculatorDesc': 'احسب دخلك ونفقاتك الشهرية',
                'registerOption': 'إنشاء حساب',
                'registerDesc': 'احفظ بياناتك وعدّل ميزانيتك لاحقاً',
                'reportsOption': 'التقارير',
                'reportsDesc': 'تحليل إنفاقك الشهري',
                'loginTitle': 'تسجيل الدخول',
                'registerTitle': 'إنشاء حساب جديد',
                'nameLabel': 'الاسم الكامل:',
                'emailLabel': 'البريد الإلكتروني:',
                'passwordLabel': 'كلمة المرور:',
                'noAccount': 'ليس لديك حساب؟',
                'haveAccount': 'لديك حساب بالفعل؟',
                'createAccount': 'أنشئ حساباً',
                'loginLink': 'سجل دخول',
                'darkMode': 'الوضع الليلي',
                'lightMode': 'الوضع النهاري'
            },
            en: {
                'appTitle': 'Shahryati | Personal Budget Management',
                'welcomeTitle': 'Welcome to Shahryati',
                'welcomeSubtitle': 'Complete tool for your personal budget',
                'loginBtn': 'Login',
                'registerBtn': 'Register',
                'logoutBtn': 'Logout',
                'calculatorTitle': 'Monthly Budget Calculator',
                'currencyLabel': 'Currency:',
                'incomeLabel': 'Monthly Income:',
                'expensesLabel': 'Fixed Expenses:',
                'rentLabel': 'Rent/Mortgage:',
                'utilitiesLabel': 'Utilities (Electricity, Water, etc):',
                'transportationLabel': 'Transportation:',
                'foodLabel': 'Food & Drinks:',
                'otherLabel': 'Other Expenses:',
                'calculateBtn': 'Calculate Budget',
                'summaryTitle': 'Budget Summary',
                'totalIncome': 'Total Income:',
                'totalExpenses': 'Total Expenses:',
                'savingsLabel': 'Savings/Deficit:',
                'adviceTitle': 'Financial Advice',
                'calculatorOption': 'Budget Calculator',
                'calculatorDesc': 'Calculate your monthly income and expenses',
                'registerOption': 'Create Account',
                'registerDesc': 'Save your data and modify later',
                'reportsOption': 'Reports',
                'reportsDesc': 'Analyze your monthly spending',
                'loginTitle': 'Login',
                'registerTitle': 'Create New Account',
                'nameLabel': 'Full Name:',
                'emailLabel': 'Email:',
                'passwordLabel': 'Password:',
                'noAccount': 'Don\'t have an account?',
                'haveAccount': 'Already have an account?',
                'createAccount': 'Create Account',
                'loginLink': 'Login',
                'darkMode': 'Dark Mode',
                'lightMode': 'Light Mode'
            }
        };

        // التهيئة عند تحميل الصفحة
        document.addEventListener('DOMContentLoaded', function() {
            initApp();
        });

        function initApp() {
            loadUserPreferences();
            loadLanguage();
            loadTheme();
            updateUI();
            translatePage();
        }

        // تحميل تفضيلات المستخدم
        function loadUserPreferences() {
            const user = JSON.parse(localStorage.getItem('currentUser'));
            if (user) {
                appState.currentUser = user;
                document.getElementById('usernameDisplay').textContent = user.name;
            }
            
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                appState.darkMode = true;
            }
        }

        // تحميل اللغة
        function loadLanguage() {
            const savedLang = localStorage.getItem('language') || 'ar';
            changeLanguage(savedLang);
        }

        // تحميل الوضع
        function loadTheme() {
            if (appState.darkMode) {
                enableDarkMode();
            } else {
                disableDarkMode();
            }
        }

        // تبديل اللغة
        function toggleLanguage() {
            const newLang = appState.currentLanguage === 'ar' ? 'en' : 'ar';
            changeLanguage(newLang);
        }

        // تغيير اللغة
        function changeLanguage(lang) {
            appState.currentLanguage = lang;
            localStorage.setItem('language', lang);
            document.documentElement.lang = lang;
            document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
            document.getElementById('languageIcon').textContent = lang === 'ar' ? 'EN' : 'AR';
            translatePage();
        }

        // تبديل الوضع الليلي
        function toggleTheme() {
            appState.darkMode = !appState.darkMode;
            if (appState.darkMode) {
                enableDarkMode();
            } else {
                disableDarkMode();
            }
        }

        // تفعيل الوضع الليلي
        function enableDarkMode() {
            document.documentElement.setAttribute('data-theme', 'dark');
            localStorage.setItem('theme', 'dark');
            document.getElementById('themeIcon').textContent = '☀️';
            document.getElementById('themeBtn').setAttribute('title', 
                translations[appState.currentLanguage]['lightMode']);
            appState.darkMode = true;
        }

        // تعطيل الوضع الليلي
        function disableDarkMode() {
            document.documentElement.removeAttribute('data-theme');
            localStorage.setItem('theme', 'light');
            document.getElementById('themeIcon').textContent = '🌙';
            document.getElementById('themeBtn').setAttribute('title', 
                translations[appState.currentLanguage]['darkMode']);
            appState.darkMode = false;
        }

        // ترجمة الصفحة
        function translatePage() {
            const lang = appState.currentLanguage;
            const t = translations[lang];
            
            // ترجمة العناصر العامة
            document.title = t['appTitle'];
            document.querySelectorAll('[data-translate]').forEach(el => {
                const key = el.getAttribute('data-translate');
                if (t[key]) {
                    el.textContent = t[key];
                }
            });
            
            // ترجمة عناصر الصفحة الرئيسية
            if (document.getElementById('homePage')) {
                document.querySelector('[data-translate="welcomeTitle"]').textContent = t['welcomeTitle'];
                document.querySelector('[data-translate="welcomeSubtitle"]').textContent = t['welcomeSubtitle'];
            }
            
            // ترجمة عناصر الحاسبة
            if (document.getElementById('calculatorPage')) {
                document.querySelector('[data-translate="calculatorTitle"]').textContent = t['calculatorTitle'];
            }
        }

        // تحديث واجهة المستخدم
        function updateUI() {
            if (appState.currentUser) {
                document.getElementById('authButtons').style.display = 'none';
                document.getElementById('userMenu').style.display = 'flex';
            } else {
                document.getElementById('authButtons').style.display = 'flex';
                document.getElementById('userMenu').style.display = 'none';
            }
        }

        // عرض صفحة معينة
        function showPage(page) {
            appState.currentPage = page;
            document.getElementById('homePage').style.display = 'none';
            document.getElementById('calculatorPage').style.display = 'none';
            
            if (page === 'home') {
                document.getElementById('homePage').style.display = 'block';
            } else if (page === 'calculator') {
                document.getElementById('calculatorPage').style.display = 'block';
            }
            
            translatePage();
        }

        // بدء استخدام الحاسبة
        function startCalculator() {
            if (appState.currentUser) {
                showPage('calculator');
            } else {
                showAuthForm('login');
            }
        }

        // عرض نموذج المصادقة
        function showAuthForm(formType) {
            document.getElementById('authModal').style.display = 'flex';
            document.getElementById('loginForm').style.display = formType === 'login' ? 'block' : 'none';
            document.getElementById('registerForm').style.display = formType === 'register' ? 'block' : 'none';
            translatePage();
        }

        // إخفاء نموذج المصادقة
        function hideAuthForm() {
            document.getElementById('authModal').style.display = 'none';
        }

        // تسجيل الدخول
        function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            const user = appState.users.find(u => u.email === email && u.password === password);
            
            if (user) {
                appState.currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(user));
                hideAuthForm();
                updateUI();
                showPage('calculator');
            } else {
                alert(appState.currentLanguage === 'ar' ? 
                    'البريد الإلكتروني أو كلمة المرور غير صحيحة' : 
                    'Invalid email or password');
            }
        }

        // تسجيل مستخدم جديد
        function register() {
            const name = document.getElementById('regName').value;
            const email = document.getElementById('regEmail').value;
            const password = document.getElementById('regPassword').value;
            
            const userExists = appState.users.some(u => u.email === email);
            
            if (userExists) {
                alert(appState.currentLanguage === 'ar' ? 
                    'هذا البريد الإلكتروني مسجل بالفعل' : 
                    'Email already registered');
                return;
            }
            
            const newUser = { 
                name, 
                email, 
                password,
                preferredTheme: appState.darkMode ? 'dark' : 'light'
            };
            
            appState.users.push(newUser);
            appState.currentUser = newUser;
            
            localStorage.setItem('users', JSON.stringify(appState.users));
            localStorage.setItem('currentUser', JSON.stringify(newUser));
            
            hideAuthForm();
            updateUI();
            showPage('calculator');
        }

        // تسجيل الخروج
        function logout() {
            appState.currentUser = null;
            localStorage.removeItem('currentUser');
            updateUI();
            showPage('home');
        }

        // تحديث رمز العملة
        function updateCurrencySymbol() {
            const currency = document.getElementById('currency').value;
            document.querySelectorAll('.currency-symbol').forEach(el => {
                el.textContent = currencySymbols[currency];
            });
        }

        // حساب الميزانية
        function calculateBudget() {
            const currency = document.getElementById('currency').value;
            const symbol = currencySymbols[currency];
            
            const income = parseFloat(document.getElementById('income').value) || 0;
            const rent = parseFloat(document.getElementById('rent').value) || 0;
            const utilities = parseFloat(document.getElementById('utilities').value) || 0;
            const transportation = parseFloat(document.getElementById('transportation').value) || 0;
            const food = parseFloat(document.getElementById('food').value) || 0;
            const other = parseFloat(document.getElementById('other').value) || 0;
            
            const totalExpenses = rent + utilities + transportation + food + other;
            const savings = income - totalExpenses;
            
            document.getElementById('total-income').innerHTML = 
                income.toLocaleString(appState.currentLanguage === 'ar' ? 'ar-SA' : 'en-US') + 
                ' <span class="currency-symbol">' + symbol + '</span>';
                
            document.getElementById('total-expenses').innerHTML = 
                totalExpenses.toLocaleString(appState.currentLanguage === 'ar' ? 'ar-SA' : 'en-US') + 
                ' <span class="currency-symbol">' + symbol + '</span>';
            
            const savingsElement = document.getElementById('savings');
            savingsElement.innerHTML = 
                savings.toLocaleString(appState.currentLanguage === 'ar' ? 'ar-SA' : 'en-US') + 
                ' <span class="currency-symbol">' + symbol + '</span>';
            
            savingsElement.style.color = savings > 0 ? 'var(--success-color)' : 
                                      savings < 0 ? 'var(--danger-color)' : 'var(--warning-color)';
            
            // تقديم النصيحة المالية
            let advice = "";
            if (appState.currentLanguage === 'ar') {
                if (savings > (income * 0.2)) {
                    advice = "ممتاز! أنت توفر أكثر من 20% من دخلك. هذا المستوى من الادخار ممتاز ويسمح لك ببناء ثروة مع الوقت.";
                } else if (savings > 0) {
                    advice = "جيد! لديك فائض في الميزانية. حاول زيادة نسبة الادخار إلى 20% من دخلك للاستفادة القصوى.";
                } else if (savings === 0) {
                    advice = "ميزانيتك متوازنة ولكن بدون مدخرات. يُنصح بتقليل بعض النفقات غير الضرورية لإنشاء مدخرات طارئة.";
                } else if (savings >= (income * -0.1)) {
                    advice = "لديك عجز بسيط. حاول تقليل النفقات غير الأساسية أو البحث عن مصادر دخل إضافية.";
                } else {
                    advice = "تحذير! لديك عجز كبير في الميزانية. يُنصح بمراجعة ميزانيتك بعناية وربما استشارة خبير مالي.";
                }
            } else {
                if (savings > (income * 0.2)) {
                    advice = "Excellent! You're saving more than 20% of your income. This savings level is great for building wealth over time.";
                } else if (savings > 0) {
                    advice = "Good! You have a budget surplus. Try to increase your savings to 20% of your income for maximum benefit.";
                } else if (savings === 0) {
                    advice = "Your budget is balanced but with no savings. Consider reducing some unnecessary expenses to create emergency savings.";
                } else if (savings >= (income * -0.1)) {
                    advice = "You have a small deficit. Try to reduce non-essential expenses or look for additional income sources.";
                } else {
                    advice = "Warning! You have a significant budget deficit. Carefully review your budget and consider consulting a financial expert.";
                }
            }
            
            document.getElementById('adviceText').textContent = advice;
            document.getElementById('result').style.display = 'block';
        }

        // عرض رسالة للخيارات القادمة
        function showComingSoon() {
            alert(appState.currentLanguage === 'ar' ? 
                "هذه الميزة ستكون متاحة قريباً" : 
                "This feature will be available soon");
        }
    </script>
</body>
</html>
